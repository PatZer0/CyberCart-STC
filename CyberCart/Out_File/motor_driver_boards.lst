C251 COMPILER V5.60.0,  motor_driver_boards                                                21/04/24  20:51:24  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE motor_driver_boards
OBJECT MODULE PLACED IN .\Out_File\motor_driver_boards.obj
COMPILER INVOKED BY: C:\Keil_v5\C251\BIN\C251.EXE Project\CODE\motor_driver_boards.c XSMALL INTR2 WARNINGLEVEL(3) OPTIMI
                    -ZE(0,SPEED) BROWSE INCDIR(Libraries\libraries;Libraries\seekfree_libraries;Libraries\seekfree_peripheral;Project\CODE;Pr
                    -oject\USER\inc;Project\USER\src;Libraries\seekfree_components) DEBUG PRINT(.\Out_File\motor_driver_boards.lst) TABS(2) O
                    -BJECT(.\Out_File\motor_driver_boards.obj) 

stmt  level    source

    1          #include "motor_driver_boards.h"
    2          
    3          // void motor_drivers_pwm_init()
    4          // {
    5          //     // ÂèÇÊï∞ÔºöÊ®°Âùó_Á´ØÂè£, È¢ëÁéá, Âç†Á©∫ÊØî(√∑10000)
    6          //     pwm_init(PWMA_CH1P_P60, 30000, 1000);   // XÊñπÂêëÈ©±Âä®ÊùøPB, 3KHz, 10%Âç†Á©∫ÊØî
    7          //     pwm_init(PWMA_CH2N_P63, 30000, 1000);   // XÊñπÂêëÈ©±Âä®ÊùøPAÔºå3KHz, 10%Âç†Á©∫ÊØî
    8          //     pwm_init(PWMA_CH4N_P67, 30000, 1000);   // YÊñπÂêëÈ©±Âä®ÊùøPB, 3KHz, 10%Âç†Á©∫ÊØî
    9          //     pwm_init(PWMA_CH3P_P14, 30000, 1000);   // YÊñπÂêëÈ©±Âä®ÊùøPA, 3KHz, 10%Âç†Á©∫ÊØî
   10          // }
   11          
   12          //-------------------------------------------------------------------------------------------------------
             -------------
   13          //  @brief      Ë∞ÉÊï¥ËΩÆÂ≠êÊñπÂêë
   14          //  @param      <X/Y>_<FRONT/REAR/ALL>      ÊåáÂÆöËΩÆÂ≠ê
   15          //  @param      <FORWARD/BACKWARD/STOP>     ÊåáÂÆöÊñπÂêë
   16          //  @return     void
   17          //  @since      v1.0 by PatZer0 on 2024.04.18
   18          //  *example  wheel_direction(X_FRONT, FORWARD); // XÊñπÂêëÂâçËΩÆÊ≠£ËΩ¨
   19          //  *desc       Êó†Ë°•ÂÖÖÊèèËø∞
   20          //-------------------------------------------------------------------------------------------------------
             -------------
   21          void wheel_direction(WHEEL_SEL_enum wheel_select, WHEEL_DIR_enum wheel_direction)
   22          {
   23   1          switch (wheel_select)
   24   1          {
   25   2              case X_FRONT:
   26   2                  if (wheel_direction == FORWARD)
   27   2                  {
   28   3                      gpio_wheel_x_front_forward = 1;
   29   3                      gpio_wheel_x_front_backward = 0;
   30   3                  }
   31   2                  else if (wheel_direction == BACKWARD)
   32   2                  {
   33   3                      gpio_wheel_x_front_forward = 0;
   34   3                      gpio_wheel_x_front_backward = 1;
   35   3                  }
   36   2                  else if (wheel_direction == STOP)
   37   2                  {
   38   3                      gpio_wheel_x_front_forward = 0;
   39   3                      gpio_wheel_x_front_backward = 0;
   40   3                  }
   41   2                  break;
   42   2              case X_REAR:
   43   2                  if (wheel_direction == FORWARD)
   44   2                  {
   45   3                      gpio_wheel_x_rear_forward = 1;
   46   3                      gpio_wheel_x_rear_backward = 0;
   47   3                  }
   48   2                  else if (wheel_direction == BACKWARD)
   49   2                  {
   50   3                      gpio_wheel_x_rear_forward = 0;
   51   3                      gpio_wheel_x_rear_backward = 1;
   52   3                  }
   53   2                  else if (wheel_direction == STOP)
   54   2                  {
C251 COMPILER V5.60.0,  motor_driver_boards                                                21/04/24  20:51:24  PAGE 2   

   55   3                      gpio_wheel_x_rear_forward = 0;
   56   3                      gpio_wheel_x_rear_backward = 0;
   57   3                  }
   58   2                  break;
   59   2              case X_ALL:
   60   2                  if (wheel_direction == FORWARD)
   61   2                  {
   62   3                      gpio_wheel_x_front_forward = 1;
   63   3                      gpio_wheel_x_front_backward = 0;
   64   3                      gpio_wheel_x_rear_forward = 1;
   65   3                      gpio_wheel_x_rear_backward = 0;
   66   3                  }
   67   2                  else if (wheel_direction == BACKWARD)
   68   2                  {
   69   3                      gpio_wheel_x_front_forward = 0;
   70   3                      gpio_wheel_x_front_backward = 1;
   71   3                      gpio_wheel_x_rear_forward = 0;
   72   3                      gpio_wheel_x_rear_backward = 1;
   73   3                  }
   74   2                  else if (wheel_direction == STOP)
   75   2                  {
   76   3                      gpio_wheel_x_front_forward = 0;
   77   3                      gpio_wheel_x_front_backward = 0;
   78   3                      gpio_wheel_x_rear_forward = 0;
   79   3                      gpio_wheel_x_rear_backward = 0;
   80   3                  }
   81   2                  break;
   82   2              case Y_FRONT:
   83   2                  if (wheel_direction == FORWARD)
   84   2                  {
   85   3                      gpio_wheel_y_front_forward = 1;
   86   3                      gpio_wheel_y_front_backward = 0;
   87   3                  }
   88   2                  else if (wheel_direction == BACKWARD)
   89   2                  {
   90   3                      gpio_wheel_y_front_forward = 0;
   91   3                      gpio_wheel_y_front_backward = 1;
   92   3                  }
   93   2                  else if (wheel_direction == STOP)
   94   2                  {
   95   3                      gpio_wheel_y_front_forward = 0;
   96   3                      gpio_wheel_y_front_backward = 0;
   97   3                  }
   98   2                  break;
   99   2              case Y_REAR:
  100   2                  if (wheel_direction == FORWARD)
  101   2                  {
  102   3                      gpio_wheel_y_rear_forward = 1;
  103   3                      gpio_wheel_y_rear_backward = 0;
  104   3                  }
  105   2                  else if (wheel_direction == BACKWARD)
  106   2                  {
  107   3                      gpio_wheel_y_rear_forward = 0;
  108   3                      gpio_wheel_y_rear_backward = 1;
  109   3                  }
  110   2                  else if (wheel_direction == STOP)
  111   2                  {
  112   3                      gpio_wheel_y_rear_forward = 0;
  113   3                      gpio_wheel_y_rear_backward = 0;
  114   3                  }
  115   2                  break;
  116   2              case Y_ALL:
  117   2                  if (wheel_direction == FORWARD)
  118   2                  {
  119   3                      gpio_wheel_y_front_forward = 1;
  120   3                      gpio_wheel_y_front_backward = 0;
C251 COMPILER V5.60.0,  motor_driver_boards                                                21/04/24  20:51:24  PAGE 3   

  121   3                      gpio_wheel_y_rear_forward = 1;
  122   3                      gpio_wheel_y_rear_backward = 0;
  123   3                  }
  124   2                  else if (wheel_direction == BACKWARD)
  125   2                  {
  126   3                      gpio_wheel_y_front_forward = 0;
  127   3                      gpio_wheel_y_front_backward = 1;
  128   3                      gpio_wheel_y_rear_forward = 0;
  129   3                      gpio_wheel_y_rear_backward = 1;
  130   3                  }
  131   2                  else if (wheel_direction == STOP)
  132   2                  {
  133   3                      gpio_wheel_y_front_forward = 0;
  134   3                      gpio_wheel_y_front_backward = 0;
  135   3                      gpio_wheel_y_rear_forward = 0;
  136   3                      gpio_wheel_y_rear_backward = 0;
  137   3                  }
  138   2                  break;
  139   2              case ALL:
  140   2                  if (wheel_direction == FORWARD)
  141   2                  {
  142   3                      gpio_wheel_x_front_forward = 1;
  143   3                      gpio_wheel_x_front_backward = 0;
  144   3                      gpio_wheel_x_rear_forward = 1;
  145   3                      gpio_wheel_x_rear_backward = 0;
  146   3                      gpio_wheel_y_front_forward = 1;
  147   3                      gpio_wheel_y_front_backward = 0;
  148   3                      gpio_wheel_y_rear_forward = 1;
  149   3                      gpio_wheel_y_rear_backward = 0;
  150   3                  }
  151   2                  else if (wheel_direction == BACKWARD)
  152   2                  {
  153   3                      gpio_wheel_x_front_forward = 0;
  154   3                      gpio_wheel_x_front_backward = 1;
  155   3                      gpio_wheel_x_rear_forward = 0;
  156   3                      gpio_wheel_x_rear_backward = 1;
  157   3                      gpio_wheel_y_front_forward = 0;
  158   3                      gpio_wheel_y_front_backward = 1;
  159   3                      gpio_wheel_y_rear_forward = 0;
  160   3                      gpio_wheel_y_rear_backward = 1;
  161   3                  }
  162   2                  else if (wheel_direction == STOP)
  163   2                  {
  164   3                      gpio_wheel_x_front_forward = 0;
  165   3                      gpio_wheel_x_front_backward = 0;
  166   3                      gpio_wheel_x_rear_forward = 0;
  167   3                      gpio_wheel_x_rear_backward = 0;
  168   3                      gpio_wheel_y_front_forward = 0;
  169   3                      gpio_wheel_y_front_backward = 0;
  170   3                      gpio_wheel_y_rear_forward = 0;
  171   3                      gpio_wheel_y_rear_backward = 0;
  172   3                  }
  173   2                  break;
  174   2              default:
  175   2                  break;
  176   2          }
  177   1      }
  178          
  179          //-------------------------------------------------------------------------------------------------------
             -------------
  180          //  @brief      Ë∞ÉÊï¥ÁîµÊú∫ËΩ¨ÈÄüÂíåÊñπÂêë
  181          //  @param      <X/Y>_<FRONT/REAR/ALL>      ÊåáÂÆöËΩÆÂ≠ê
  182          //  @param      speed                       ËΩ¨ÈÄüÂÄºÔºåËåÉÂõ¥Ë¥ü10000~Ê≠£10000
  183          //  @return     void
  184          //  @since      v1.0 by PatZer0 on 2024.04.18
  185          //  *example  wheel_adjust(X_FRONT, 5000); // XÊñπÂêëÂâçËΩÆÂêëÂâçËΩ¨, ËΩ¨ÈÄü50%
C251 COMPILER V5.60.0,  motor_driver_boards                                                21/04/24  20:51:24  PAGE 4   

  186          //  *desc       ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÁõ¥Êé•‰ΩøÁî®Ê≠§ÂáΩÊï∞Âç≥ÂèØÔºåÈô§ÈùûÈúÄË¶Å‰øùÊåÅËΩ¨ÈÄüË∞ÉÊï¥ÊñπÂêëÔºåÂê
             -¶Âàô‰∏çÈúÄË¶Å‰ΩøÁî®Êç¢ÂêëÂáΩÊï∞
  187          //-------------------------------------------------------------------------------------------------------
             -------------
  188          void wheel_adjust(WHEEL_SEL_enum wheel_select, int speed)
  189          {
  190   1          unsigned int pwm_duty_value;
  191   1      
  192   1          // Êõ¥ÊîπËΩÆÂ≠êÊñπÂêë
  193   1          if      (speed > 0) wheel_direction(wheel_select, FORWARD);
  194   1          else if (speed < 0) wheel_direction(wheel_select, BACKWARD);
  195   1          else                wheel_direction(wheel_select, STOP);
  196   1      
  197   1          // Á°ÆÂÆöPWMÂç†Á©∫ÊØî
  198   1          if (speed >= 0) pwm_duty_value = speed;
  199   1          else pwm_duty_value = -speed;
  200   1      
  201   1          // Ê†°ÂáÜÈÄüÂ∫¶ËæìÂÖ•ÈáèÔºåÈôêÂà∂Âú®ËåÉÂõ¥ÂÜÖ
  202   1          if (speed > 10000) speed = 10000;
  203   1          else if (speed < -10000) speed = -10000;
  204   1      
  205   1          switch (wheel_select)
  206   1          {
  207   2              case X_FRONT:
  208   2                  pwm_duty(WHEEL_X_FRONT_PWMCH, pwm_duty_value);
  209   2                  break;
  210   2              case X_REAR:
  211   2                  pwm_duty(WHEEL_X_REAR_PWMCH, pwm_duty_value);
  212   2                  break;
  213   2              case X_ALL:
  214   2                  pwm_duty(WHEEL_X_FRONT_PWMCH, pwm_duty_value);
  215   2                  pwm_duty(WHEEL_X_REAR_PWMCH, pwm_duty_value);
  216   2                  break;
  217   2              case Y_FRONT:
  218   2                  pwm_duty(WHEEL_Y_FRONT_PWMCH, pwm_duty_value);
  219   2                  break;
  220   2              case Y_REAR:
  221   2                  pwm_duty(WHEEL_Y_REAR_PWMCH, pwm_duty_value);
  222   2                  break;
  223   2              case Y_ALL:
  224   2                  pwm_duty(WHEEL_Y_FRONT_PWMCH, pwm_duty_value);
  225   2                  pwm_duty(WHEEL_Y_REAR_PWMCH, pwm_duty_value);
  226   2                  break;
  227   2              case ALL:
  228   2                  pwm_duty(WHEEL_X_FRONT_PWMCH, pwm_duty_value);
  229   2                  pwm_duty(WHEEL_X_REAR_PWMCH, pwm_duty_value);
  230   2                  pwm_duty(WHEEL_Y_FRONT_PWMCH, pwm_duty_value);
  231   2                  pwm_duty(WHEEL_Y_REAR_PWMCH, pwm_duty_value);
  232   2                  break;
  233   2              default:
  234   2                  break;
  235   2          }
  236   1      }
  237          
  238          //-------------------------------------------------------------------------------------------------------
             -------------
  239          //  @brief      Ë∞ÉÊï¥ÁîµÊú∫ËΩ¨ÈÄü
  240          //  @param      <X/Y>_<FRONT/REAR/ALL>      ÊåáÂÆöËΩÆÂ≠ê
  241          //  @param      speed                       ËΩ¨ÈÄüÂÄºÔºåËåÉÂõ¥0~10000
  242          //  @return     void
  243          //  @since      v1.0 by PatZer0 on 2024.04.18
  244          //  *example  wheel_speed(X_FRONT, 5000); // XÊñπÂêëÂâçËΩÆÂêëÂâçËΩ¨, ËΩ¨ÈÄü50%
  245          //  *desc       ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÁõ¥Êé•‰ΩøÁî®Ê≠§ÂáΩÊï∞Âç≥ÂèØÔºåÈô§ÈùûÈúÄË¶Å‰øùÊåÅËΩ¨ÈÄüË∞ÉÊï¥ÊñπÂêëÔºåÂê
             -¶Âàô‰∏çÈúÄË¶Å‰ΩøÁî®Êç¢ÂêëÂáΩÊï∞
  246          //-------------------------------------------------------------------------------------------------------
             -------------
C251 COMPILER V5.60.0,  motor_driver_boards                                                21/04/24  20:51:24  PAGE 5   

  247          void wheel_speed(WHEEL_SEL_enum wheel_select, unsigned int speed)
  248          {
  249   1          unsigned int pwm_duty_value;
  250   1          if (speed > 10000) pwm_duty_value = 10000;
  251   1      
  252   1          switch (wheel_select)
  253   1          {
  254   2              case X_FRONT:
  255   2                  pwm_duty(WHEEL_X_FRONT_PWMCH, pwm_duty_value);
  256   2                  break;
  257   2              case X_REAR:
  258   2                  pwm_duty(WHEEL_X_REAR_PWMCH, pwm_duty_value);
  259   2                  break;
  260   2              case X_ALL:
  261   2                  pwm_duty(WHEEL_X_FRONT_PWMCH, pwm_duty_value);
  262   2                  pwm_duty(WHEEL_X_REAR_PWMCH, pwm_duty_value);
  263   2                  break;
  264   2              case Y_FRONT:
  265   2                  pwm_duty(WHEEL_Y_FRONT_PWMCH, pwm_duty_value);
  266   2                  break;
  267   2              case Y_REAR:
  268   2                  pwm_duty(WHEEL_Y_REAR_PWMCH, pwm_duty_value);
  269   2                  break;
  270   2              case Y_ALL:
  271   2                  pwm_duty(WHEEL_Y_FRONT_PWMCH, pwm_duty_value);
  272   2                  pwm_duty(WHEEL_Y_REAR_PWMCH, pwm_duty_value);
  273   2                  break;
  274   2              case ALL:
  275   2                  pwm_duty(WHEEL_X_FRONT_PWMCH, pwm_duty_value);
  276   2                  pwm_duty(WHEEL_X_REAR_PWMCH, pwm_duty_value);
  277   2                  pwm_duty(WHEEL_Y_FRONT_PWMCH, pwm_duty_value);
  278   2                  pwm_duty(WHEEL_Y_REAR_PWMCH, pwm_duty_value);
  279   2                  break;
  280   2              default:
  281   2                  break;
  282   2          }
  283   1      }


Module Information          Static   Overlayable
------------------------------------------------
  code size            =      1172     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------     ------
  xdata-const size     =    ------     ------
  edata size           =        16     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =    ------     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
